<rss version="2.0" xmlns:atom="http://www.w3.org/2005/Atom"><channel><title>DeepArena – 安装部署</title><link>https://deeparena.github.io/website/docs/getting-started/deploy/</link><description>Recent content in 安装部署 on DeepArena</description><generator>Hugo -- gohugo.io</generator><language>zh</language><atom:link href="https://deeparena.github.io/website/docs/getting-started/deploy/index.xml" rel="self" type="application/rss+xml"/><item><title>Docs: 单机部署</title><link>https://deeparena.github.io/website/docs/getting-started/deploy/deploy_allinone/</link><pubDate>Mon, 01 Jan 0001 00:00:00 +0000</pubDate><guid>https://deeparena.github.io/website/docs/getting-started/deploy/deploy_allinone/</guid><description/></item><item><title>Docs: 集群部署</title><link>https://deeparena.github.io/website/docs/getting-started/deploy/deploy_cluster/</link><pubDate>Mon, 01 Jan 0001 00:00:00 +0000</pubDate><guid>https://deeparena.github.io/website/docs/getting-started/deploy/deploy_cluster/</guid><description>
&lt;h2 id="harbor部署">Harbor部署&lt;/h2>
&lt;table>
&lt;thead>
&lt;tr>
&lt;th>IP&lt;/th>
&lt;th>User&lt;/th>
&lt;th>Password&lt;/th>
&lt;/tr>
&lt;/thead>
&lt;tbody>
&lt;tr>
&lt;td>192.168.10.34&lt;/td>
&lt;td>ntx&lt;/td>
&lt;td>P@ssw0rd&lt;/td>
&lt;/tr>
&lt;/tbody>
&lt;/table>
&lt;p>部署harbor镜像仓库,后续集群部署所需镜像使用Harbor提供;&lt;/p>
&lt;h3 id="安装docker">安装docker&lt;/h3>
&lt;div class="highlight">&lt;pre tabindex="0" style="background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4;">&lt;code class="language-bash" data-lang="bash">&lt;span style="display:flex;">&lt;span>&lt;span style="color:#8f5902;font-style:italic"># 安装docker&lt;/span>
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>sudo apt-get remove docker docker-engine docker.io containerd runc
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>sudo apt-get update
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>sudo apt-get install ca-certificates curl gnupg lsb-release
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>curl -fsSL https://download.docker.com/linux/ubuntu/gpg &lt;span style="color:#000;font-weight:bold">|&lt;/span> sudo gpg --dearmor -o /usr/share/keyrings/docker-archive-keyring.gpg
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>&lt;span style="color:#204a87">echo&lt;/span> &lt;span style="color:#4e9a06">\
&lt;/span>&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>&lt;span style="color:#4e9a06">&lt;/span> &lt;span style="color:#4e9a06">&amp;#34;deb [arch=&lt;/span>&lt;span style="color:#204a87;font-weight:bold">$(&lt;/span>dpkg --print-architecture&lt;span style="color:#204a87;font-weight:bold">)&lt;/span>&lt;span style="color:#4e9a06"> signed-by=/usr/share/keyrings/docker-archive-keyring.gpg] https://download.docker.com/linux/ubuntu \
&lt;/span>&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>&lt;span style="color:#4e9a06"> &lt;/span>&lt;span style="color:#204a87;font-weight:bold">$(&lt;/span>lsb_release -cs&lt;span style="color:#204a87;font-weight:bold">)&lt;/span>&lt;span style="color:#4e9a06"> stable&amp;#34;&lt;/span> &lt;span style="color:#000;font-weight:bold">|&lt;/span> sudo tee /etc/apt/sources.list.d/docker.list &amp;gt; /dev/null
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>sudo apt-get update
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>sudo apt-get install docker-ce&lt;span style="color:#ce5c00;font-weight:bold">=&lt;/span>5:19.03.15~3-0~ubuntu-focal docker-ce-cli&lt;span style="color:#ce5c00;font-weight:bold">=&lt;/span>5:19.03.15~3-0~ubuntu-focal containerd.io
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>&lt;span style="color:#8f5902;font-style:italic"># 用户ntx加到docker组&lt;/span>
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>sudo groupadd docker
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>&lt;span style="color:#8f5902;font-style:italic"># sudo gpasswd -a ntx docker&lt;/span>
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>sudo gpasswd -a &lt;span style="color:#4e9a06">${&lt;/span>&lt;span style="color:#000">USER&lt;/span>&lt;span style="color:#4e9a06">}&lt;/span> docker
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>sudo service docker restart
&lt;/span>&lt;/span>&lt;/code>&lt;/pre>&lt;/div>&lt;h3 id="安装docker-compose">安装docker-compose&lt;/h3>
&lt;div class="highlight">&lt;pre tabindex="0" style="background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4;">&lt;code class="language-bash" data-lang="bash">&lt;span style="display:flex;">&lt;span>sudo curl -L &lt;span style="color:#4e9a06">&amp;#34;https://github.com/docker/compose/releases/download/1.29.2/docker-compose-&lt;/span>&lt;span style="color:#204a87;font-weight:bold">$(&lt;/span>uname -s&lt;span style="color:#204a87;font-weight:bold">)&lt;/span>&lt;span style="color:#4e9a06">-&lt;/span>&lt;span style="color:#204a87;font-weight:bold">$(&lt;/span>uname -m&lt;span style="color:#204a87;font-weight:bold">)&lt;/span>&lt;span style="color:#4e9a06">&amp;#34;&lt;/span> -o /usr/local/bin/docker-compose
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>sudo chmod +x /usr/local/bin/docker-compose
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>&lt;span style="color:#8f5902;font-style:italic"># 验证安装&lt;/span>
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>docker-compose -v
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>&lt;span style="color:#8f5902;font-style:italic"># 如果安装后docker-compose不可用，创建符号链接到/use/bin&lt;/span>
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>&lt;span style="color:#8f5902;font-style:italic"># sudo ln -s /usr/local/bin/docker-compose /usr/bin/docker-compose&lt;/span>
&lt;/span>&lt;/span>&lt;/code>&lt;/pre>&lt;/div>&lt;h3 id="下载离线包">下载离线包&lt;/h3>
&lt;p>下载harbor离线包并解压&lt;/p>
&lt;div class="highlight">&lt;pre tabindex="0" style="background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4;">&lt;code class="language-bash" data-lang="bash">&lt;span style="display:flex;">&lt;span>$ sudo mkdir -p /data/harbor/data
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>$ &lt;span style="color:#204a87">cd&lt;/span> /data/harbor/
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>&lt;span style="color:#8f5902;font-style:italic"># 下载离线包&lt;/span>
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>$ wget https://github.com/goharbor/harbor/releases/download/v2.4.1/harbor-offline-installer-v2.4.1.tgz
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>&lt;span style="color:#8f5902;font-style:italic"># 解压&lt;/span>
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>$ tar zxf harbor-offline-installer-v2.4.1.tgz
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>&lt;span style="color:#8f5902;font-style:italic"># 从压缩包中加载docker镜像&lt;/span>
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>$ docker image load -i harbor/harbor.v2.4.1.tar.gz
&lt;/span>&lt;/span>&lt;/code>&lt;/pre>&lt;/div>&lt;h3 id="修改配置文件">修改配置文件&lt;/h3>
&lt;p>修改配置文件harbor.yml&lt;/p>
&lt;div class="highlight">&lt;pre tabindex="0" style="background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4;">&lt;code class="language-bash" data-lang="bash">&lt;span style="display:flex;">&lt;span>$ &lt;span style="color:#204a87">cd&lt;/span> /data/harbor/harbor
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>$ cp harbor.yml.tmpl harbor.yml
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>$ vim harbor.yml
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>&lt;span style="color:#8f5902;font-style:italic"># 修改hostname为harbor节点ip&lt;/span>
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>hostname: 192.168.10.34
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>&lt;span style="color:#8f5902;font-style:italic"># 修改http端口为5000&lt;/span>
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>http:
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> port: &lt;span style="color:#0000cf;font-weight:bold">5000&lt;/span>
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>&lt;span style="color:#8f5902;font-style:italic"># 设置admin用户的密码&lt;/span>
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>harbor_admin_password: Harbor12345
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>&lt;span style="color:#8f5902;font-style:italic"># 配置默认数据目录&lt;/span>
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>data_volume: /data/harbor/data
&lt;/span>&lt;/span>&lt;/code>&lt;/pre>&lt;/div>&lt;h3 id="启动harbor服务">启动harbor服务&lt;/h3>
&lt;div class="highlight">&lt;pre tabindex="0" style="background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4;">&lt;code class="language-bash" data-lang="bash">&lt;span style="display:flex;">&lt;span>&lt;span style="color:#8f5902;font-style:italic"># 启动harbor&lt;/span>
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>$ &lt;span style="color:#204a87">cd&lt;/span> /data/harbor/harbor
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>$ sudo ./install.sh --with-chartmuseum
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>&lt;span style="color:#8f5902;font-style:italic"># 停止harbor&lt;/span>
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>&lt;span style="color:#8f5902;font-style:italic"># docker-compose down&lt;/span>
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>&lt;span style="color:#8f5902;font-style:italic"># 重启&lt;/span>
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>&lt;span style="color:#8f5902;font-style:italic"># sudo ./install.sh --with-chartmuseum&lt;/span>
&lt;/span>&lt;/span>&lt;/code>&lt;/pre>&lt;/div>&lt;p>通过&lt;a href="http://192.168.10.34:5000">http://192.168.10.34:5000&lt;/a>即可访问harbor镜像仓库:&lt;/p>
&lt;h2 id="nfs部署">NFS部署&lt;/h2>
&lt;p>持久化存储是安装 AI平台 的必备条件。NFS用于为有状态服务动态提供持久化存储。&lt;/p>
&lt;h3 id="nfs服务端">nfs服务端&lt;/h3>
&lt;table>
&lt;thead>
&lt;tr>
&lt;th>IP&lt;/th>
&lt;th>User&lt;/th>
&lt;th>Password&lt;/th>
&lt;/tr>
&lt;/thead>
&lt;tbody>
&lt;tr>
&lt;td>192.168.10.34&lt;/td>
&lt;td>ntx&lt;/td>
&lt;td>P@ssw0rd&lt;/td>
&lt;/tr>
&lt;/tbody>
&lt;/table>
&lt;h4 id="安装nfs-server">安装nfs server&lt;/h4>
&lt;div class="highlight">&lt;pre tabindex="0" style="background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4;">&lt;code class="language-bash" data-lang="bash">&lt;span style="display:flex;">&lt;span>&lt;span style="color:#8f5902;font-style:italic"># 安装nfs server&lt;/span>
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>sudo apt-get update
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>sudo apt install nfs-kernel-server -y
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>sudo sh -c &lt;span style="color:#4e9a06">&amp;#39;echo /mnt/nvme0n1 &amp;#34;*(rw,sync,insecure,no_subtree_check,no_root_squash)&amp;#34; &amp;gt;&amp;gt; /etc/exports&amp;#39;&lt;/span>
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>sudo exportfs -a
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>sudo systemctl restart nfs-kernel-server
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>sudo systemctl &lt;span style="color:#204a87">enable&lt;/span> nfs-kernel-server
&lt;/span>&lt;/span>&lt;/code>&lt;/pre>&lt;/div>&lt;h4 id="文件系统配额">文件系统配额&lt;/h4>
&lt;p>开启文件系统配额管理。
安装配额工具：&lt;/p>
&lt;div class="highlight">&lt;pre tabindex="0" style="background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4;">&lt;code class="language-bash" data-lang="bash">&lt;span style="display:flex;">&lt;span>$ sudo apt update
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>$ sudo apt install quota
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>&lt;span style="color:#8f5902;font-style:italic"># 验证安装&lt;/span>
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>$ quota --version
&lt;/span>&lt;/span>&lt;/code>&lt;/pre>&lt;/div>&lt;p>安装配额内核模块：&lt;/p>
&lt;div class="highlight">&lt;pre tabindex="0" style="background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4;">&lt;code class="language-bash" data-lang="bash">&lt;span style="display:flex;">&lt;span>&lt;span style="color:#8f5902;font-style:italic"># 验证是否安装&lt;/span>
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>$ find /lib/modules/&lt;span style="color:#4e9a06">`&lt;/span>uname -r&lt;span style="color:#4e9a06">`&lt;/span> -type f -name &lt;span style="color:#4e9a06">&amp;#39;*quota_v*.ko*&amp;#39;&lt;/span>
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>&lt;span style="color:#8f5902;font-style:italic"># 如果已安装会输出一下内容&lt;/span>
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>Output
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>/lib/modules/5.4.0-109-generic/kernel/fs/quota/quota_v1.ko
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>/lib/modules/5.4.0-109-generic/kernel/fs/quota/quota_v2.ko
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>&lt;span style="color:#8f5902;font-style:italic"># 如果未安装，安装linux-image-extra-virtual&lt;/span>
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>$ sudo apt install linux-image-extra-virtual
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>&lt;span style="color:#8f5902;font-style:italic"># 如果上一步安装后因为内核原因还是不能输出期望的内容。安装对应内核的模块&lt;/span>
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>&lt;span style="color:#8f5902;font-style:italic"># eg： sudo apt install &amp;#39;linux-modules-extra-5.4.0-40-generic&amp;#39;&lt;/span>
&lt;/span>&lt;/span>&lt;/code>&lt;/pre>&lt;/div>&lt;p>修改/etc/fstab，更新文件系统挂载选项：增加&lt;code>usrquota,grpquota&lt;/code>。&lt;/p>
&lt;p>重新挂载文件系统使配置文件生效：&lt;/p>
&lt;div class="highlight">&lt;pre tabindex="0" style="background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4;">&lt;code class="language-bash" data-lang="bash">&lt;span style="display:flex;">&lt;span>$ sudo mount -o remount /mnt/nvme0n1
&lt;/span>&lt;/span>&lt;/code>&lt;/pre>&lt;/div>&lt;p>允许使用基于用户与用户组的配额管理:&lt;/p>
&lt;div class="highlight">&lt;pre tabindex="0" style="background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4;">&lt;code class="language-bash" data-lang="bash">&lt;span style="display:flex;">&lt;span>$ sudo quotacheck -ugm /mnt/nvme0n1
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>$ sudo quotaon -v /mnt/nvme0n1
&lt;/span>&lt;/span>&lt;/code>&lt;/pre>&lt;/div>&lt;p>拷贝安装包并解压：&lt;/p>
&lt;div class="highlight">&lt;pre tabindex="0" style="background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4;">&lt;code class="language-bash" data-lang="bash">&lt;span style="display:flex;">&lt;span>&lt;span style="color:#8f5902;font-style:italic"># AIPLATEFORM_OFFINE_PATH=/pathtoaipalteform&lt;/span>
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>&lt;span style="color:#000">AIPLATEFORM_OFFINE_PATH&lt;/span>&lt;span style="color:#ce5c00;font-weight:bold">=&lt;/span>/home/ntx
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>&lt;span style="color:#8f5902;font-style:italic"># 需要将安装包deeparena-installer.tar.gz拷贝到AIPLATEFORM_OFFINE_PATH&lt;/span>
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>&lt;span style="color:#8f5902;font-style:italic"># 解压安装包&lt;/span>
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>&lt;span style="color:#204a87">cd&lt;/span> &lt;span style="color:#000">$AIPLATEFORM_OFFINE_PATH&lt;/span>
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>tar -zxvf deeparena-installer.tar.gz
&lt;/span>&lt;/span>&lt;/code>&lt;/pre>&lt;/div>&lt;p>部署文件系统配额管理服务：&lt;/p>
&lt;div class="highlight">&lt;pre tabindex="0" style="background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4;">&lt;code class="language-bash" data-lang="bash">&lt;span style="display:flex;">&lt;span>&lt;span style="color:#8f5902;font-style:italic"># 配额管理服务&lt;/span>
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>cp &lt;span style="color:#000">$AIPLATEFORM_OFFINE_PATH&lt;/span>/deeparena-installer/bin/nfs-quota /usr/local/bin/nfs-quota
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>chmod +x /usr/local/bin/nfs-quota
&lt;/span>&lt;/span>&lt;/code>&lt;/pre>&lt;/div>&lt;p>配置服务自启：&lt;/p>
&lt;div class="highlight">&lt;pre tabindex="0" style="background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4;">&lt;code class="language-bash" data-lang="bash">&lt;span style="display:flex;">&lt;span>$ sudo tee /etc/systemd/system/fs-quota.service &lt;span style="color:#4e9a06">&amp;lt;&amp;lt;-&amp;#39;EOF&amp;#39;
&lt;/span>&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>&lt;span style="color:#4e9a06">[Unit]
&lt;/span>&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>&lt;span style="color:#4e9a06">After=network.service
&lt;/span>&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>&lt;span style="color:#4e9a06">
&lt;/span>&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>&lt;span style="color:#4e9a06">[Service]
&lt;/span>&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>&lt;span style="color:#4e9a06">ExecStart=/usr/local/bin/nfs-quota -d /mnt/nvme0n1 -p 9088
&lt;/span>&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>&lt;span style="color:#4e9a06">
&lt;/span>&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>&lt;span style="color:#4e9a06">[Install]
&lt;/span>&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>&lt;span style="color:#4e9a06">WantedBy=default.target
&lt;/span>&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>&lt;span style="color:#4e9a06">
&lt;/span>&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>&lt;span style="color:#4e9a06">EOF&lt;/span>
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>$ sudo chmod &lt;span style="color:#0000cf;font-weight:bold">664&lt;/span> /etc/systemd/system/fs-quota.service
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>$ sudo systemctl daemon-reload
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>&lt;span style="color:#8f5902;font-style:italic"># 开机自启&lt;/span>
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>$ sudo systemctl &lt;span style="color:#204a87">enable&lt;/span> fs-quota
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>&lt;span style="color:#8f5902;font-style:italic"># 启动服务&lt;/span>
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>$ sudo systemctl start fs-quota
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>&lt;span style="color:#8f5902;font-style:italic"># 查看服务状态&lt;/span>
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>$ sudo systemctl status fs-quota
&lt;/span>&lt;/span>&lt;/code>&lt;/pre>&lt;/div>&lt;h3 id="nfs客户端">nfs客户端&lt;/h3>
&lt;table>
&lt;thead>
&lt;tr>
&lt;th>IP&lt;/th>
&lt;th>User&lt;/th>
&lt;th>Password&lt;/th>
&lt;/tr>
&lt;/thead>
&lt;tbody>
&lt;tr>
&lt;td>192.168.10.35&lt;/td>
&lt;td>ntx&lt;/td>
&lt;td>P@ssw0rd&lt;/td>
&lt;/tr>
&lt;/tbody>
&lt;/table>
&lt;p>安装nfs client并挂载nfs server：&lt;/p>
&lt;div class="highlight">&lt;pre tabindex="0" style="background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4;">&lt;code class="language-bash" data-lang="bash">&lt;span style="display:flex;">&lt;span>&lt;span style="color:#8f5902;font-style:italic"># 安装nfs client&lt;/span>
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>&lt;span style="color:#8f5902;font-style:italic"># nfs server ip&lt;/span>
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>&lt;span style="color:#000">NFS_SERVER_IP&lt;/span>&lt;span style="color:#ce5c00;font-weight:bold">=&lt;/span>192.168.10.34
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>sudo apt install nfs-common
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>sudo showmount -e &lt;span style="color:#000">$NFS_SERVER_IP&lt;/span>
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>&lt;span style="color:#8f5902;font-style:italic">#在nfs客户端创建目录 /mnt/deeparena_nfs&lt;/span>
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>sudo mkdir -p /mnt/deeparena_nfs
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>&lt;span style="color:#8f5902;font-style:italic">#挂载nfs服务端&lt;/span>
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>sudo mount -t nfs &lt;span style="color:#000">$NFS_SERVER_IP&lt;/span>:/mnt/nvme0n1 /mnt/deeparena_nfs
&lt;/span>&lt;/span>&lt;/code>&lt;/pre>&lt;/div>&lt;h2 id="kubernetes安装部署">Kubernetes安装部署&lt;/h2>
&lt;p>参考Kubernetes安装管理手册。&lt;/p>
&lt;h2 id="ai平台服务部署">AI平台服务部署&lt;/h2>
&lt;h3 id="基础服务部署">基础服务部署&lt;/h3>
&lt;blockquote>
&lt;p>提示：
如果在非Kubernetes控制节点部署基础服务，请确保服务器已经安装helm和kubectl并且能够访问kubernetes集群api-serve，建议在kubernetes控制节点运行部署脚本。&lt;/p>
&lt;/blockquote>
&lt;p>拷贝安装包并解压：&lt;/p>
&lt;div class="highlight">&lt;pre tabindex="0" style="background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4;">&lt;code class="language-bash" data-lang="bash">&lt;span style="display:flex;">&lt;span>&lt;span style="color:#8f5902;font-style:italic"># AIPLATEFORM_OFFINE_PATH=/pathtoaipalteform&lt;/span>
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>&lt;span style="color:#000">AIPLATEFORM_OFFINE_PATH&lt;/span>&lt;span style="color:#ce5c00;font-weight:bold">=&lt;/span>/home/ntx
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>&lt;span style="color:#8f5902;font-style:italic"># 需要将安装包deeparena-installer.tar.gz拷贝到AIPLATEFORM_OFFINE_PATH&lt;/span>
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>&lt;span style="color:#8f5902;font-style:italic"># 解压安装包&lt;/span>
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>&lt;span style="color:#204a87">cd&lt;/span> &lt;span style="color:#000">$AIPLATEFORM_OFFINE_PATH&lt;/span>
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>tar -zxvf deeparena-installer.tar.gz
&lt;/span>&lt;/span>&lt;/code>&lt;/pre>&lt;/div>&lt;p>部署基础服务：
执行部署脚本过程中需要根据实际情况修改变量，参考一下表格：&lt;/p>
&lt;table>
&lt;thead>
&lt;tr>
&lt;th>nfs server ip&lt;/th>
&lt;th>192.168.10.34&lt;/th>
&lt;/tr>
&lt;/thead>
&lt;tbody>
&lt;tr>
&lt;td>nfs server path&lt;/td>
&lt;td>/mnt/nvme0n1&lt;/td>
&lt;/tr>
&lt;tr>
&lt;td>elastic password&lt;/td>
&lt;td>P@ssw0rd&lt;/td>
&lt;/tr>
&lt;tr>
&lt;td>redis password&lt;/td>
&lt;td>P@ssw0rd&lt;/td>
&lt;/tr>
&lt;tr>
&lt;td>harbor username&lt;/td>
&lt;td>admin&lt;/td>
&lt;/tr>
&lt;tr>
&lt;td>harbor password&lt;/td>
&lt;td>Harbor12345&lt;/td>
&lt;/tr>
&lt;tr>
&lt;td>nfs server&lt;/td>
&lt;td>192.168.10.34&lt;/td>
&lt;/tr>
&lt;tr>
&lt;td>k8s control plane node&lt;/td>
&lt;td>192.168.10.102&lt;/td>
&lt;/tr>
&lt;/tbody>
&lt;/table>
&lt;div class="highlight">&lt;pre tabindex="0" style="background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4;">&lt;code class="language-bash" data-lang="bash">&lt;span style="display:flex;">&lt;span>&lt;span style="color:#204a87">cd&lt;/span> &lt;span style="color:#000">$AIPLATEFORM_OFFINE_PATH&lt;/span>/deeparena-installer
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>&lt;span style="color:#8f5902;font-style:italic"># 执行部署脚本&lt;/span>
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>./deploy.sh -d
&lt;/span>&lt;/span>&lt;/code>&lt;/pre>&lt;/div>&lt;h3 id="web服务部署">web服务部署&lt;/h3>
&lt;table>
&lt;thead>
&lt;tr>
&lt;th>IP&lt;/th>
&lt;th>User&lt;/th>
&lt;th>Password&lt;/th>
&lt;/tr>
&lt;/thead>
&lt;tbody>
&lt;tr>
&lt;td>192.168.10.35&lt;/td>
&lt;td>ntx&lt;/td>
&lt;td>P@ssw0rd&lt;/td>
&lt;/tr>
&lt;/tbody>
&lt;/table>
&lt;p>todo： 小勇&lt;/p>
&lt;p>web ui 服务部署&lt;/p>
&lt;div class="highlight">&lt;pre tabindex="0" style="background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4;">&lt;code class="language-bash" data-lang="bash">&lt;span style="display:flex;">&lt;span>docker run -it -d -p 3008:3008 --name aiserver-web registry.harbor:5000/resource/ai_server:1.0.0
&lt;/span>&lt;/span>&lt;/code>&lt;/pre>&lt;/div></description></item></channel></rss>